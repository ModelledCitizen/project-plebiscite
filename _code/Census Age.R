##### Age Only -- Manual #####
url <- "https://api.census.gov/data/2010/sf1?get=P0120001,P0120003,P0120004,P0120005,P0120006,P0120007,P0120008,P0120009,P0120010,P0120011,P0120012,P0120013,P0120014,P0120015,P0120016,P0120017,P0120018,P0120019,P0120020,P0120021,P0120022,P0120023,P0120024,P0120025,P0120027,P0120028,P0120029,P0120030,P0120031,P0120032,P0120033,P0120034,P0120035,P0120036,P0120037,P0120038,P0120039,P0120040,P0120041,P0120042,P0120043,P0120044,P0120045,P0120046,P0120047,P0120048,P0120049&for=block:*&in=state:42%20county:101"

json <- RCurl::getURL(url)
phl <- jsonlite::fromJSON(json)
phl <- data.frame(phl, stringsAsFactors = FALSE)
phl <- phl[2:18873, ]

names(phl) <- c("P0120001","P0120003","P0120004","P0120005","P0120006","P0120007","P0120008","P0120009","P0120010","P0120011","P0120012","P0120013","P0120014","P0120015","P0120016","P0120017","P0120018","P0120019","P0120020","P0120021","P0120022","P0120023","P0120024","P0120025","P0120027","P0120028","P0120029","P0120030","P0120031","P0120032","P0120033","P0120034","P0120035","P0120036","P0120037","P0120038","P0120039","P0120040","P0120041","P0120042","P0120043","P0120044","P0120045","P0120046","P0120047","P0120048","P0120049","state","county","tract","block")

phl$geoid <- paste0(phl$state, phl$county, phl$tract, phl$block)


ages <- c(3,7,12,16,19,20,21,23,27,32,37,42,47,52,57,61,63,66,68,72,77,82,90,3,7,12,16,19,20,21,23,27,32,37,42,47,52,57,61,63,66,68,72,77,82,90)


phl$censusage <- round(rowSums(data.matrix(phl[ , c(2:47)]) * ages) / as.numeric(phl$P0120001))

rm(ages, json, url)

save(phl, file = "phl-census2.Rdata")


